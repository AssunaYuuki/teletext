<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= folderName %> ‚Äî –°—Ç—Ä–∞–Ω–∏—Ü—ã</title>
  <link rel="stylesheet" href="/global.css">
  <style>
    .folder-container {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      padding: 20px 0;
      background: var(--bg);
      color: var(--fg);
      font-family: var(--font-mono);
    }

    .content-wrapper {
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--accent);
      padding-bottom: 10px;
    }

    .header h1 {
      color: var(--accent);
      margin: 0;
      font-size: 2rem;
      text-shadow: 0 0 8px rgba(0, 204, 102, 0.6);
    }

    .breadcrumb {
      font-size: 0.9rem;
      opacity: 0.7;
      margin-top: 5px;
    }

    .breadcrumb a {
      color: var(--accent);
      text-decoration: none;
    }
    .breadcrumb a:hover {
      text-decoration: underline;
    }


  </style>
</head>
<body>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
  <header class="nav-bar">
    <div class="breadcrumb">
      <a href="/">üè† –ì–ª–∞–≤–Ω–∞—è</a>
      <% if (breadcrumb && breadcrumb.length > 0) { %>
        <% breadcrumb.forEach((crumb, i) => { %>
          <% if (i === breadcrumb.length - 1) { %>
            <span> ‚Üí <%= crumb.name %></span>
          <% } else { %>
            <a href="/folder/<%= encodeURIComponent(crumb.path) %>"> ‚Üí <%= crumb.name %></a>
          <% } %>
        <% }) %>
      <% } %>
    </div>

    <h2>
      <% if (hasLogo) { %>
        <img src="<%= logoUrl %>?t=<%= Date.now() %>" alt="–õ–æ–≥–æ—Ç–∏–ø" style="height:32px;vertical-align:middle;margin-right:8px;">
      <% } %>
      <%= folderName %>
    </h2>
  </header>

  <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <div class="folder-container">
    <div class="content-wrapper">
      <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
      <div class="header">
        <h1><%= folderName %></h1>
        <div class="breadcrumb">
          –ü–æ–¥–ø–∞–ø–æ–∫: <%= folders.length %>, —Å—Ç—Ä–∞–Ω–∏—Ü: <%= pages.length %>
        </div>
      </div>

      <!-- –°–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∞–ø–æ–∫ -->
      <% if (folders.length > 0) { %>
        <section>
          <h3>üìÅ –ü–æ–¥–ø–∞–ø–∫–∏</h3>
          <div class="grid">
            <% folders.forEach(folder => { %>
              <a href="/folder/<%= encodeURIComponent(currentPath ? currentPath + '/' + folder : folder) %>" class="card">
                <% if (folderLogos && folderLogos[folder]) { %>
                  <img src="<%= folderLogos[folder] %>?t=<%= Date.now() %>" alt="–õ–æ–≥–æ—Ç–∏–ø" style="height:32px; max-width: 100%; object-fit: contain;">
                <% } else { %>
                  <span style="color:#ffcc00;font-size:0.9rem;">üåê</span>
                <% } %>
                <span style="font-size:0.85rem; text-align:center; display:block; word-wrap:break-word; line-height:1.2;"><%= folder %></span>
              </a>
            <% }) %>
          </div>
        </section>
      <% } %>

          <!-- –°–µ—Ç–∫–∞ –º–∏–Ω–∏–∞—Ç—é—Ä —Å—Ç—Ä–∞–Ω–∏—Ü -->
          <% if (pages.length > 0) { %>
            <section class="thumbs-grid">
              <h3>üñºÔ∏è –°—Ç—Ä–∞–Ω–∏—Ü—ã</h3>
              <div class="grid">
                <% pages.forEach(item => { %>
                  <a
                    href="/page/<%= encodeURIComponent(currentPath) %>/<%= item.page %>"
                    class="thumb-item">
                    <% if (item.hasThumb) { %>
                      <img src="<%= `/teletext/${currentPath}/${item.page}.png` %>" alt="–°—Ç—Ä. <%= item.page %>">
                    <% } else { %>
                      <div style="height:100px; background:#f8fff8; display:flex; align-items:center; justify-content:center; color:var(--accent); font-size:0.9rem;">
                        <%= item.page %>
                      </div>
                    <% } %>
                    <span><%= item.page %></span>
                  </a>
                <% }) %>
              </div>
            </section>
          <% } else if(folders.length === 0) { %>
            <div class="empty">
              <p>–ù–µ—Ç –Ω–∏ –ø–æ–¥–ø–∞–ø–æ–∫, –Ω–∏ —Å—Ç—Ä–∞–Ω–∏—Ü.</p>
            </div>
          <% } %>

  <footer>
    <small>–¢–µ–ª–µ—Ç–µ–∫—Å—Ç | –ü—É—Ç—å: <%= currentPath || '–∫–æ—Ä–µ–Ω—å' %></small>
  </footer>

  <script>
    // –ó–≤—É–∫ —â–µ–ª—á–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('mouseenter', () => {
        const audio = document.getElementById('clickSound');
        if (audio) {
          audio.currentTime = 0;
          audio.play().catch(e => console.log('Audio play error:', e));
        }
      });
    });
  </script>

</body>
</html>