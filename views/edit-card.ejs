<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ ‚Äî <%= folderName %></title>
  <link rel="stylesheet" href="/global.css">
  <style>
    .edit-container {
      max-width: 650px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }

    .card-preview {
      background: #0a220a;
      border: 2px solid #00ff88;
      border-radius: 6px;
      padding: 16px;
      margin: 20px auto;
      max-width: 300px;
      font-family: var(--font-mono);
      color: #a0d9a0;
      font-size: 0.95rem;
      box-shadow: inset 0 0 8px rgba(0, 60, 30, 0.8);
    }

    .card-preview img {
      height: 40px;
      max-width: 100%;
      object-fit: contain;
      margin-bottom: 8px;
    }

    .card-preview .card-title {
      font-size: 1rem;
      font-weight: bold;
      color: #00ffaa;
      word-break: break-word;
    }

    .form-section {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 6px;
      margin: 20px 0;
      text-align: left;
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      margin-bottom: 6px;
      color: var(--accent);
      font-weight: bold;
    }

    .form-group input[type="text"],
    .form-group input[type="file"] {
      width: 100%;
      padding: 8px 12px;
      background: var(--hover-bg);
      border: 1px solid var(--accent);
      color: var(--fg);
      font-family: var(--font-mono);
      border-radius: 4px;
      box-sizing: border-box;
    }

    .btn {
      display: inline-block;
      padding: 10px 20px;
      background: var(--card-bg);
      border: 1px solid var(--accent);
      color: var(--accent);
      text-decoration: none;
      font-weight: bold;
      border-radius: 4px;
      margin: 5px;
      transition: all 0.2s;
      cursor: pointer;
    }

    .btn:hover {
      background: var(--accent);
      color: var(--bg);
    }

    .btn-red {
      border-color: #ff6666;
      color: #ff6666;
    }

    .btn-red:hover {
      background: #ff6666;
      color: var(--bg);
    }

    .btn-group {
      text-align: center;
      margin-top: 20px;
    }

    .path-display {
      font-family: var(--font-mono);
      font-size: 0.9rem;
      color: var(--accent);
      margin: 10px 0;
    }

    h2 {
      color: var(--accent);
      margin: 10px 0;
    }
  </style>
</head>
<body class="crt">

  <header>
    <h1>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏</h1>
    <p class="subtitle"><%= folderName %></p>
    <p class="path-display">–ü—É—Ç—å: <code><%= archivePath %></code></p>
  </header>

  <div class="edit-container">
    <!-- –ü—Ä–µ–≤—å—é –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div class="card-preview">
      <% if (hasLogo) { %>
        <img src="<%= logoUrl %>?t=<%= Date.now() %>" alt="–õ–æ–≥–æ—Ç–∏–ø">
      <% } else { %>
        <div style="height:40px; display:flex; align-items:center; justify-content:center; color:#ffcc00;">üåê</div>
      <% } %>
      <div class="card-title"><%= currentTitle %></div>
    </div>

    <!-- –§–æ—Ä–º–∞: –ª–æ–≥–æ—Ç–∏–ø + –Ω–∞–∑–≤–∞–Ω–∏–µ -->
    <form method="POST" action="/save-card/<%= encodeURIComponent(archivePath) %>" enctype="multipart/form-data">
      <div class="form-section">
        <h2>üñºÔ∏è –õ–æ–≥–æ—Ç–∏–ø</h2>
        <div class="form-group">
          <label>–¢–µ–∫—É—â–∏–π: <%= hasLogo ? '‚úÖ –ï—Å—Ç—å' : '‚ùå –ù–µ—Ç' %></label>
          <% if (hasLogo) { %>
            <img src="<%= logoUrl %>?t=<%= Date.now() %>" alt="–õ–æ–≥–æ—Ç–∏–ø" style="max-height:60px; max-width:100%; margin-top:8px; border:1px solid var(--accent); border-radius:3px;">
          <% } %>
        </div>

        <div class="form-group">
          <label>–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π (SVG/PNG/JPG)</label>
          <input type="file" name="logo" accept=".svg,.png,.jpg,.jpeg">
          <small style="display:block; margin-top:4px; opacity:0.7;">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º ‚Äî –ª–æ–≥–æ—Ç–∏–ø –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è</small>
        </div>
      </div>

      <div class="form-section">
        <h2>üî§ –ù–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞</h2>
        <div class="form-group">
          <label for="title">–¢–µ–∫—Å—Ç –ø–æ–¥ –ª–æ–≥–æ—Ç–∏–ø–æ–º</label>
          <input type="text" id="title" name="title" value="<%= currentTitle %>" required maxlength="50">
          <small style="display:block; margin-top:4px; opacity:0.7;">–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ <code>title.txt</code></small>
        </div>
      </div>

      <div class="btn-group">
        <button type="submit" class="btn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <a href="/folder/<%= encodeURIComponent(archivePath) %>" class="btn">‚Üê –û—Ç–º–µ–Ω–∞</a>
      </div>
    </form>

    <!-- –£–¥–∞–ª–µ–Ω–∏–µ -->
    <% if (hasLogo) { %>
      <div class="form-section" style="border-color: #ff6666;">
        <h2 style="color: #ff6666;">üóë –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø</h2>
        <form method="POST" action="/logo-delete/<%= encodeURIComponent(archivePath) %>"
              onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø –∏–∑ –ø–∞–ø–∫–∏?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.')">
          <button type="submit" class="btn btn-red">üóë –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø</button>
        </form>
      </div>
    <% } %>

    <div style="margin-top: 30px; font-size: 0.85rem; opacity: 0.7;">
      <a href="/" class="btn" style="padding:6px 12px;">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
    </div>
  </div>

</body>
</html>